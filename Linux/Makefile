LIBRARY_SOURCES = $(shell echo ../Src/JTAG-MPSSE-Blaster.c)
SCANTOOL_SOURCES = $(shell echo ../Src/*.c)

LIBRARY_OBJECTS = $(LIBRARY_SOURCES:.c=.o)
SCANTOOL_OBJECTS = $(SCANTOOL_SOURCES:.c=.o)

TARGET_LIBRARY = libjtag_hw_mpsse.so
TARGET_SCANTOOL = jtag_scan_tool

CPPFLAGS = -fPIC -g -std=c99 -Wall
LDFLAGS_LIBRARY = -ldl -shared
LDFLAGS_SCANTOOL = -ldl

all: $(TARGET_LIBRARY) $(TARGET_SCANTOOL)

clean:
	rm -f $(LIBRARY_OBJECTS) $(TARGET_LIBRARY) $(SCANTOOL_OBJECTS) $(TARGET_SCANTOOL)

$(TARGET_LIBRARY) : $(LIBRARY_OBJECTS)
	$(CC) $(CPPFLAGS) $(LIBRARY_OBJECTS) -o $@ $(LDFLAGS_LIBRARY)

$(TARGET_SCANTOOL) : $(SCANTOOL_OBJECTS)
	$(CC) $(CPPFLAGS) $(SCANTOOL_OBJECTS) -o $@ $(LDFLAGS_SCANTOOL)
